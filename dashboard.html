<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å—Ç–£—Å–ª—É–≥–∏ | Wisconsin GVRPA</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --bg: #0f111a; --card: #1a1d2e; --accent: #3b82f6; --text: #e2e8f0; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        
        /* –®–∞–ø–∫–∞ */
        .user-bar { display: flex; justify-content: space-between; align-items: center; max-width: 1000px; margin: 0 auto 30px; background: var(--card); padding: 15px 25px; border-radius: 12px; border: 1px solid #2d334d; }
        #user-name { font-weight: bold; color: var(--accent); }
        .header { text-align: center; margin-bottom: 40px; }
        
        /* –ö–Ω–æ–ø–∫–∏ –≤ —à–∞–ø–∫–µ */
        .btn-logout { background: #ef4444; color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; }
        .btn-profile { margin-left: 15px; background: none; border: 1px solid var(--accent); color: var(--accent); padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px; }

        /* –°–ï–¢–ö–ê –ü–õ–ò–¢–û–ß–ï–ö - –ò–°–ü–†–ê–í–õ–ï–ù–ê */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); 
            gap: 20px; 
            max-width: 1000px; 
            margin: 0 auto; 
        }
        
        .service-card { 
            background: var(--card); 
            padding: 25px; 
            border-radius: 15px; 
            border: 1px solid #2d334d; 
            transition: 0.3s; 
            cursor: pointer; 
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .service-card:hover { transform: translateY(-5px); border-color: var(--accent); box-shadow: 0 10px 20px rgba(0,0,0,0.4); }
        .service-card span { font-size: 40px; display: block; margin-bottom: 10px; }
        .service-card h3 { margin: 10px 0 5px; font-size: 18px; }
        .service-card p { margin: 0; font-size: 13px; color: #94a3b8; }
        
        /* –û—Å–æ–±–∞—è –ø–ª–∏—Ç–∫–∞ –ø–æ–ª–∏—Ü–∏–∏ */
        #police-card { border-color: #1d4ed8; background: rgba(29, 78, 216, 0.05); }
    </style>
</head>
<body>

<div class="user-bar">
    <div>
        <span id="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        <button class="btn-profile" onclick="window.location.href='profile.html'">–ú–æ–∏ –∑–∞—è–≤–∫–∏</button>
    </div>
    <button class="btn-logout" onclick="logout()">–í—ã–π—Ç–∏</button>
</div>

<div class="header">
    <h1>–ö–∞–ª—Ç–£—Å–ª—É–≥–∏</h1>
    <p style="color: #94a3b8;">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç–∞–ª —à—Ç–∞—Ç–∞ –í–∏—Å–∫–æ–Ω—Å–∏–Ω (GVRPA)</p>
</div>

<div class="grid">
    <div class="service-card" onclick="openService('–ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ')"><span>üõÇ</span><h3>–ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ</h3><p>ID-–∫–∞—Ä—Ç–∞</p></div>
    <div class="service-card" onclick="openService('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≤—Ç–æ')"><span>üöó</span><h3>–ê–≤—Ç–æ</h3><p>–£—á–µ—Ç –¢–°</p></div>
    <div class="service-card" onclick="openService('–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å')"><span>üè†</span><h3>–î–æ–º</h3><p>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</p></div>
    <div class="service-card" onclick="openService('–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞')"><span>ü™™</span><h3>–ü—Ä–∞–≤–∞</h3><p>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ A,B,C</p></div>
    <div class="service-card" onclick="openService('–ë—Ä–∞–∫')"><span>üíç</span><h3>–ë—Ä–∞–∫</h3><p>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–æ—é–∑–∞</p></div>
    <div class="service-card" onclick="openService('–°—É–¥')"><span>‚öñÔ∏è</span><h3>–°—É–¥</h3><p>–ò—Å–∫–∏ –∏ –∂–∞–ª–æ–±—ã</p></div>
    <div class="service-card" onclick="openService('–î–¢–ü')"><span>üí•</span><h3>–î–¢–ü</h3><p>–û—Ç—á–µ—Ç –æ–± –∞–≤–∞—Ä–∏–∏</p></div>
    <div class="service-card" onclick="openService('–ü—Ä–∞–≤–∏–ª–∞')"><span>üìú</span><h3>–ü—Ä–∞–≤–∏–ª–∞</h3><p>–£—Å—Ç–∞–≤ –∏ –ü–î–î</p></div>
    
    <div id="police-card" class="service-card" onclick="openService('–ü–æ–ª–∏—Ü–∏—è')" style="display: none;">
        <span>üëÆ‚Äç‚ôÇÔ∏è</span>
        <h3>–ë–∞–∑–∞ –ú–í–î</h3>
        <p>–°–ª—É–∂–µ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø</p>
    </div>
</div>

<script>
    const S_URL = 'https://exbhxsdwqznmroxrzxjp.supabase.co';
    const S_KEY = '–í–°–¢–ê–í–¨_–°–í–û–ô_–î–õ–ò–ù–ù–´–ô_–ö–õ–Æ–ß'; 
    const supabaseClient = supabase.createClient(S_URL, S_KEY);

    async function checkUser() {
        try {
            const { data: { user } } = await supabaseClient.auth.getUser();
            if (!user) { 
                window.location.href = "index.html"; 
                return;
            }
            
            document.getElementById('user-name').innerText = "üë§ " + user.email.split('@')[0];

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–æ–ª–∏—Ü–∏–∏
            const { data: profile } = await supabaseClient
                .from('profiles')
                .select('role')
                .eq('id', user.id)
                .single();

            if (profile && (profile.role === 'police' || profile.role === 'admin')) {
                document.getElementById('police-card').style.display = 'flex';
            }
        } catch (err) {
            console.log("–û—à–∏–±–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –∏–ª–∏ —Ä–æ–ª–∏:", err);
        }
    }

    function openService(type) {
        const routes = {
            '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≤—Ç–æ': 'auto.html',
            '–ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ': 'passport.html',
            '–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å': 'house.html',
            '–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞': 'license.html',
            '–ë—Ä–∞–∫': 'marriage.html',
            '–°—É–¥': 'court.html',
            '–î–¢–ü': 'accident.html',
            '–ü—Ä–∞–≤–∏–ª–∞': 'rules.html',
            '–ü–æ–ª–∏—Ü–∏—è': 'police_db.html'
        };
        if (routes[type]) { window.location.href = routes[type]; }
    }
    
    async function logout() { await supabaseClient.auth.signOut(); window.location.href = "index.html"; }
    
    checkUser();
</script>
</body>
</html>
